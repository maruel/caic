(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();const Ft=!1,Dt=(t,e)=>t===e,qt=Symbol("solid-track"),at={equals:Dt};let Ct=Pt;const z=1,ut=2,At={owned:null,cleanups:null,context:null,owner:null};var B=null;let gt=null,Ut=null,E=null,P=null,Q=null,ht=0;function ot(t,e){const n=E,s=B,r=t.length===0,i=e===void 0?s:e,o=r?At:{owned:null,cleanups:null,context:i?i.context:null,owner:i},l=r?t:()=>t(()=>X(()=>rt(o)));B=o,E=null;try{return lt(l,!0)}finally{E=n,B=s}}function J(t,e){e=e?Object.assign({},at,e):at;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},s=r=>(typeof r=="function"&&(r=r(n.value)),It(n,r));return[Lt.bind(n),s]}function k(t,e,n){const s=pt(t,e,!1,z);it(s)}function Et(t,e,n){Ct=Jt;const s=pt(t,e,!1,z);s.user=!0,Q?Q.push(s):it(s)}function j(t,e,n){n=n?Object.assign({},at,n):at;const s=pt(t,e,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=n.equals||void 0,it(s),Lt.bind(s)}function X(t){if(E===null)return t();const e=E;E=null;try{return t()}finally{E=e}}function jt(t){Et(()=>X(t))}function Bt(t){return B===null||(B.cleanups===null?B.cleanups=[t]:B.cleanups.push(t)),t}function Vt(t){const e=j(t),n=j(()=>bt(e()));return n.toArray=()=>{const s=n();return Array.isArray(s)?s:s!=null?[s]:[]},n}function Lt(){if(this.sources&&this.state)if(this.state===z)it(this);else{const t=P;P=null,lt(()=>ft(this),!1),P=t}if(E){const t=this.observers?this.observers.length:0;E.sources?(E.sources.push(this),E.sourceSlots.push(t)):(E.sources=[this],E.sourceSlots=[t]),this.observers?(this.observers.push(E),this.observerSlots.push(E.sources.length-1)):(this.observers=[E],this.observerSlots=[E.sources.length-1])}return this.value}function It(t,e,n){let s=t.value;return(!t.comparator||!t.comparator(s,e))&&(t.value=e,t.observers&&t.observers.length&&lt(()=>{for(let r=0;r<t.observers.length;r+=1){const i=t.observers[r],o=gt&&gt.running;o&&gt.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?P.push(i):Q.push(i),i.observers&&Mt(i)),o||(i.state=z)}if(P.length>1e6)throw P=[],new Error},!1)),e}function it(t){if(!t.fn)return;rt(t);const e=ht;Wt(t,t.value,e)}function Wt(t,e,n){let s;const r=B,i=E;E=B=t;try{s=t.fn(e)}catch(o){return t.pure&&(t.state=z,t.owned&&t.owned.forEach(rt),t.owned=null),t.updatedAt=n+1,Nt(o)}finally{E=i,B=r}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?It(t,s):t.value=s,t.updatedAt=n)}function pt(t,e,n,s=z,r){const i={fn:t,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:B,context:B?B.context:null,pure:n};return B===null||B!==At&&(B.owned?B.owned.push(i):B.owned=[i]),i}function ct(t){if(t.state===0)return;if(t.state===ut)return ft(t);if(t.suspense&&X(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<ht);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===z)it(t);else if(t.state===ut){const s=P;P=null,lt(()=>ft(t,e[0]),!1),P=s}}function lt(t,e){if(P)return t();let n=!1;e||(P=[]),Q?n=!0:Q=[],ht++;try{const s=t();return Ht(n),s}catch(s){n||(Q=null),P=null,Nt(s)}}function Ht(t){if(P&&(Pt(P),P=null),t)return;const e=Q;Q=null,e.length&&lt(()=>Ct(e),!1)}function Pt(t){for(let e=0;e<t.length;e++)ct(t[e])}function Jt(t){let e,n=0;for(e=0;e<t.length;e++){const s=t[e];s.user?t[n++]=s:ct(s)}for(e=0;e<n;e++)ct(t[e])}function ft(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const s=t.sources[n];if(s.sources){const r=s.state;r===z?s!==e&&(!s.updatedAt||s.updatedAt<ht)&&ct(s):r===ut&&ft(s,e)}}}function Mt(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=ut,n.pure?P.push(n):Q.push(n),n.observers&&Mt(n))}}function rt(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),s=t.sourceSlots.pop(),r=n.observers;if(r&&r.length){const i=r.pop(),o=n.observerSlots.pop();s<r.length&&(i.sourceSlots[o]=s,r[s]=i,n.observerSlots[s]=o)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)rt(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)rt(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Kt(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Nt(t,e=B){throw Kt(t)}function bt(t){if(typeof t=="function"&&!t.length)return bt(t());if(Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++){const s=bt(t[n]);Array.isArray(s)?e.push.apply(e,s):e.push(s)}return e}return t}const Qt=Symbol("fallback");function kt(t){for(let e=0;e<t.length;e++)t[e]()}function Xt(t,e,n={}){let s=[],r=[],i=[],o=0,l=e.length>1?[]:null;return Bt(()=>kt(i)),()=>{let u=t()||[],h=u.length,_,c;return u[qt],X(()=>{let L,O,D,x,w,m,$,C,M;if(h===0)o!==0&&(kt(i),i=[],s=[],r=[],o=0,l&&(l=[])),n.fallback&&(s=[Qt],r[0]=ot(b=>(i[0]=b,n.fallback())),o=1);else if(o===0){for(r=new Array(h),c=0;c<h;c++)s[c]=u[c],r[c]=ot(N);o=h}else{for(D=new Array(h),x=new Array(h),l&&(w=new Array(h)),m=0,$=Math.min(o,h);m<$&&s[m]===u[m];m++);for($=o-1,C=h-1;$>=m&&C>=m&&s[$]===u[C];$--,C--)D[C]=r[$],x[C]=i[$],l&&(w[C]=l[$]);for(L=new Map,O=new Array(C+1),c=C;c>=m;c--)M=u[c],_=L.get(M),O[c]=_===void 0?-1:_,L.set(M,c);for(_=m;_<=$;_++)M=s[_],c=L.get(M),c!==void 0&&c!==-1?(D[c]=r[_],x[c]=i[_],l&&(w[c]=l[_]),c=O[c],L.set(M,c)):i[_]();for(c=m;c<h;c++)c in D?(r[c]=D[c],i[c]=x[c],l&&(l[c]=w[c],l[c](c))):r[c]=ot(N);r=r.slice(0,o=h),s=u.slice(0)}return r});function N(L){if(i[c]=L,l){const[O,D]=J(c);return l[c]=D,e(u[c],O)}return e(u[c])}}}function y(t,e){return X(()=>t(e||{}))}const Ot=t=>`Stale read from <${t}>.`;function nt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return j(Xt(()=>t.each,t.children,e||void 0))}function G(t){const e=t.keyed,n=j(()=>t.when,void 0,void 0),s=e?n:j(n,void 0,{equals:(r,i)=>!r==!i});return j(()=>{const r=s();if(r){const i=t.children;return typeof i=="function"&&i.length>0?X(()=>i(e?r:()=>{if(!X(s))throw Ot("Show");return n()})):i}return t.fallback},void 0,void 0)}function Gt(t){const e=Vt(()=>t.children),n=j(()=>{const s=e(),r=Array.isArray(s)?s:[s];let i=()=>{};for(let o=0;o<r.length;o++){const l=o,u=r[o],h=i,_=j(()=>h()?void 0:u.when,void 0,void 0),c=u.keyed?_:j(_,void 0,{equals:(N,L)=>!N==!L});i=()=>h()||(c()?[l,_,u]:void 0)}return i});return j(()=>{const s=n()();if(!s)return t.fallback;const[r,i,o]=s,l=o.children;return typeof l=="function"&&l.length>0?X(()=>l(o.keyed?i():()=>{var h;if(((h=X(n)())==null?void 0:h[0])!==r)throw Ot("Match");return i()})):l},void 0,void 0)}function et(t){return t}const Yt=t=>j(()=>t());function Zt(t,e,n){let s=n.length,r=e.length,i=s,o=0,l=0,u=e[r-1].nextSibling,h=null;for(;o<r||l<i;){if(e[o]===n[l]){o++,l++;continue}for(;e[r-1]===n[i-1];)r--,i--;if(r===o){const _=i<s?l?n[l-1].nextSibling:n[i-l]:u;for(;l<i;)t.insertBefore(n[l++],_)}else if(i===l)for(;o<r;)(!h||!h.has(e[o]))&&e[o].remove(),o++;else if(e[o]===n[i-1]&&n[l]===e[r-1]){const _=e[--r].nextSibling;t.insertBefore(n[l++],e[o++].nextSibling),t.insertBefore(n[--i],_),e[r]=n[i]}else{if(!h){h=new Map;let c=l;for(;c<i;)h.set(n[c],c++)}const _=h.get(e[o]);if(_!=null)if(l<_&&_<i){let c=o,N=1,L;for(;++c<r&&c<i&&!((L=h.get(e[c]))==null||L!==_+N);)N++;if(N>_-l){const O=e[o];for(;l<_;)t.insertBefore(n[l++],O)}else t.replaceChild(n[l++],e[o++])}else o++;else e[o++].remove()}}}const $t="_$DX_DELEGATE";function zt(t,e,n,s={}){let r;return ot(i=>{r=i,e===document?t():g(e,t(),e.firstChild?null:void 0,n)},s.owner),()=>{r(),e.textContent=""}}function T(t,e,n,s){let r;const i=()=>{const l=document.createElement("template");return l.innerHTML=t,l.content.firstChild},o=()=>(r||(r=i())).cloneNode(!0);return o.cloneNode=o,o}function Rt(t,e=window.document){const n=e[$t]||(e[$t]=new Set);for(let s=0,r=t.length;s<r;s++){const i=t[s];n.has(i)||(n.add(i),e.addEventListener(i,ee))}}function d(t,e){e==null?t.removeAttribute("class"):t.className=e}function te(t,e,n){n!=null?t.style.setProperty(e,n):t.style.removeProperty(e)}function g(t,e,n,s){if(n!==void 0&&!s&&(s=[]),typeof e!="function")return dt(t,e,s,n);k(r=>dt(t,e(),r,n),s)}function ee(t){let e=t.target;const n=`$$${t.type}`,s=t.target,r=t.currentTarget,i=u=>Object.defineProperty(t,"target",{configurable:!0,value:u}),o=()=>{const u=e[n];if(u&&!e.disabled){const h=e[`${n}Data`];if(h!==void 0?u.call(e,h,t):u.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&i(e.host),!0},l=()=>{for(;o()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const u=t.composedPath();i(u[0]);for(let h=0;h<u.length-2&&(e=u[h],!!o());h++){if(e._$host){e=e._$host,l();break}if(e.parentNode===r)break}}else l();i(s)}function dt(t,e,n,s,r){for(;typeof n=="function";)n=n();if(e===n)return n;const i=typeof e,o=s!==void 0;if(t=o&&n[0]&&n[0].parentNode||t,i==="string"||i==="number"){if(i==="number"&&(e=e.toString(),e===n))return n;if(o){let l=n[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),n=tt(t,n,s,l)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e}else if(e==null||i==="boolean")n=tt(t,n,s);else{if(i==="function")return k(()=>{let l=e();for(;typeof l=="function";)l=l();n=dt(t,l,n,s)}),()=>n;if(Array.isArray(e)){const l=[],u=n&&Array.isArray(n);if(vt(l,e,n,r))return k(()=>n=dt(t,l,n,s,!0)),()=>n;if(l.length===0){if(n=tt(t,n,s),o)return n}else u?n.length===0?St(t,l,s):Zt(t,n,l):(n&&tt(t),St(t,l));n=l}else if(e.nodeType){if(Array.isArray(n)){if(o)return n=tt(t,n,s,e);tt(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function vt(t,e,n,s){let r=!1;for(let i=0,o=e.length;i<o;i++){let l=e[i],u=n&&n[t.length],h;if(!(l==null||l===!0||l===!1))if((h=typeof l)=="object"&&l.nodeType)t.push(l);else if(Array.isArray(l))r=vt(t,l,u)||r;else if(h==="function")if(s){for(;typeof l=="function";)l=l();r=vt(t,Array.isArray(l)?l:[l],Array.isArray(u)?u:[u])||r}else t.push(l),r=!0;else{const _=String(l);u&&u.nodeType===3&&u.data===_?t.push(u):t.push(document.createTextNode(_))}}return r}function St(t,e,n=null){for(let s=0,r=e.length;s<r;s++)t.insertBefore(e[s],n)}function tt(t,e,n,s){if(n===void 0)return t.textContent="";const r=s||document.createTextNode("");if(e.length){let i=!1;for(let o=e.length-1;o>=0;o--){const l=e[o];if(r!==l){const u=l.parentNode===t;!i&&!o?u?t.replaceChild(r,l):t.insertBefore(r,n):u&&l.remove()}else i=!0}}else t.insertBefore(r,n);return[r]}class ne extends Error{constructor(e,n,s){super(n),this.status=e,this.code=n,this.details=s}}async function K(t,e,n){const s={method:t,headers:{"Content-Type":"application/json"}};n!==void 0&&(s.body=JSON.stringify(n));const r=await fetch(e,s);if(!r.ok){const i=await r.json();throw new ne(r.status,i.error.code,i.details)}return r.json()}function se(){return K("GET","/api/v1/repos")}function re(){return K("GET","/api/v1/tasks")}function ie(t){return K("POST","/api/v1/tasks",t)}function le(t){return new EventSource(`/api/v1/tasks/${t}/events`)}function oe(t,e){return K("POST",`/api/v1/tasks/${t}/input`,e)}function ae(t){return K("POST",`/api/v1/tasks/${t}/finish`)}function ue(t){return K("POST",`/api/v1/tasks/${t}/end`)}function ce(t){return K("POST",`/api/v1/tasks/${t}/pull`)}function fe(t){return K("POST",`/api/v1/tasks/${t}/push`)}function de(t){return K("POST",`/api/v1/tasks/${t}/reconnect`)}function he(t){return K("POST",`/api/v1/tasks/${t}/takeover`)}const ge="_container_1h18w_3",_e="_header_1h18w_9",me="_closeBtn_1h18w_20",be="_query_1h18w_24",ve="_messageArea_1h18w_32",pe="_placeholder_1h18w_43",ye="_inputForm_1h18w_47",we="_textInput_1h18w_53",ke="_btn_1h18w_58",$e="_btnGray_1h18w_66",Se="_btnGreen_1h18w_70",xe="_btnRed_1h18w_74",Te="_systemInit_1h18w_78",Ce="_systemMsg_1h18w_84",Ae="_assistantMsg_1h18w_90",Ee="_textBlock_1h18w_94",Be="_result_1h18w_99",Le="_resultSuccess_1h18w_106",Ie="_resultError_1h18w_110",Pe="_resultMeta_1h18w_114",Me="_resultText_1h18w_120",Ne="_toolResult_1h18w_125",Oe="_toolGroup_1h18w_135",Ge="_toolGroupInner_1h18w_148",Re="_toolBlock_1h18w_152",Fe="_toolBlockPre_1h18w_164",p={container:ge,header:_e,closeBtn:me,query:be,messageArea:ve,placeholder:pe,inputForm:ye,textInput:we,btn:ke,btnGray:$e,btnGreen:Se,btnRed:xe,systemInit:Te,systemMsg:Ce,assistantMsg:Ae,textBlock:Ee,result:Be,resultSuccess:Le,resultError:Ie,resultMeta:Pe,resultText:Me,toolResult:Ne,toolGroup:Oe,toolGroupInner:Ge,toolBlock:Re,toolBlockPre:Fe};var De=T("<p>Waiting for agent output..."),qe=T("<button type=button>Finish"),Ue=T("<button type=button>Reconnect"),je=T("<button type=button>Takeover"),Ve=T('<form><input type=text placeholder="Send message to agent..."><button type=submit>Send</button><button type=button>Pull</button><button type=button>Push</button><button type=button>End'),We=T("<div><div><h3>Task #</h3><button>Close</button></div><div></div><div>"),He=T("<div>Session started &middot; <!> &middot; "),Je=T("<div>[<!>]"),_t=T("<div>"),Ke=T("<div>$<!> &middot; <!>s &middot; <!> turns"),Qe=T("<div><strong>"),Xe=T("<details><summary> tools: </summary><div>"),Ye=T("<details><summary>tool result"),Ze=T("<details><summary></summary><pre>");function ze(t){const[e,n]=J([]),[s,r]=J(""),[i,o]=J(!1);Et(()=>{const x=t.taskId;n([]);const w=le(x);w.addEventListener("message",m=>{try{const $=JSON.parse(m.data);n(C=>[...C,$])}catch{}}),Bt(()=>w.close())});async function l(){const x=s().trim();if(x){o(!0);try{await oe(t.taskId,{prompt:x}),r("")}finally{o(!1)}}}const u=()=>{const x=t.taskState;return x==="running"||x==="starting"||x==="waiting"},h=()=>t.taskState==="waiting";async function _(){await ae(t.taskId)}async function c(){await ce(t.taskId)}async function N(){await fe(t.taskId)}async function L(){await ue(t.taskId)}async function O(){await de(t.taskId)}async function D(){await he(t.taskId)}return(()=>{var x=We(),w=x.firstChild,m=w.firstChild;m.firstChild;var $=m.nextSibling,C=w.nextSibling,M=C.nextSibling;return g(m,()=>t.taskId,null),$.$$click=()=>t.onClose(),g(C,()=>t.taskQuery),g(M,y(nt,{get each(){return en(e())},children:b=>y(Gt,{get children(){return[y(et,{get when(){return b.kind==="tool"},get children(){return y(sn,{get toolBlocks(){return b.toolBlocks}})}}),y(et,{get when(){return b.kind==="text"||b.kind==="other"},get children(){return y(nt,{get each(){return b.messages},children:I=>y(tn,{msg:I})})}})]}})}),null),g(M,y(G,{get when(){return e().length===0},get children(){var b=De();return k(()=>d(b,p.placeholder)),b}}),null),g(x,y(G,{get when(){return u()},get children(){var b=Ve(),I=b.firstChild,Y=I.nextSibling,V=Y.nextSibling,q=V.nextSibling,a=q.nextSibling;return b.addEventListener("submit",f=>{f.preventDefault(),l()}),I.$$input=f=>r(f.currentTarget.value),V.$$click=()=>c(),q.$$click=()=>N(),g(b,y(G,{get when(){return h()},get children(){return[(()=>{var f=qe();return f.$$click=()=>_(),k(()=>d(f,`${p.btn} ${p.btnGreen}`)),f})(),(()=>{var f=Ue();return f.$$click=()=>O(),k(()=>d(f,`${p.btn} ${p.btnGray}`)),f})(),(()=>{var f=je();return f.$$click=()=>D(),k(()=>d(f,`${p.btn} ${p.btnGray}`)),f})()]}}),a),a.$$click=()=>L(),k(f=>{var A=p.inputForm,R=i(),F=p.textInput,v=i()||!s().trim(),W=`${p.btn} ${p.btnGray}`,U=`${p.btn} ${p.btnGray}`,H=`${p.btn} ${p.btnRed}`;return A!==f.e&&d(b,f.e=A),R!==f.t&&(I.disabled=f.t=R),F!==f.a&&d(I,f.a=F),v!==f.o&&(Y.disabled=f.o=v),W!==f.i&&d(V,f.i=W),U!==f.n&&d(q,f.n=U),H!==f.s&&d(a,f.s=H),f},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),k(()=>I.value=s()),b}}),null),k(b=>{var I=p.container,Y=p.header,V=p.closeBtn,q=p.query,a=p.messageArea;return I!==b.e&&d(x,b.e=I),Y!==b.t&&d(w,b.t=Y),V!==b.a&&d($,b.a=V),q!==b.o&&d(C,b.o=q),a!==b.i&&d(M,b.i=a),b},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),x})()}function tn(t){return y(Gt,{get children(){return[y(et,{get when(){return Yt(()=>t.msg.type==="system")()&&t.msg.subtype==="init"},get children(){var e=He(),n=e.firstChild,s=n.nextSibling;return s.nextSibling,g(e,()=>t.msg.model,s),g(e,()=>t.msg.claude_code_version,null),k(()=>d(e,p.systemInit)),e}}),y(et,{get when(){return t.msg.type==="system"},get children(){var e=Je(),n=e.firstChild,s=n.nextSibling;return s.nextSibling,g(e,()=>t.msg.subtype,s),k(()=>d(e,p.systemMsg)),e}}),y(et,{get when(){return t.msg.type==="assistant"},get children(){var e=_t();return g(e,y(nt,{get each(){var n,s;return((s=(n=t.msg.message)==null?void 0:n.content)==null?void 0:s.filter(r=>r.type==="text"))??[]},children:n=>(()=>{var s=_t();return g(s,()=>n.text),k(()=>d(s,p.textBlock)),s})()})),k(()=>d(e,p.assistantMsg)),e}}),y(et,{get when(){return t.msg.type==="result"},get children(){var e=Qe(),n=e.firstChild;return g(n,()=>t.msg.is_error?"Error":"Done"),g(e,y(G,{get when(){return t.msg.result},get children(){var s=_t();return g(s,()=>t.msg.result),k(()=>d(s,p.resultText)),s}}),null),g(e,y(G,{get when(){return t.msg.total_cost_usd},get children(){var s=Ke(),r=s.firstChild,i=r.nextSibling,o=i.nextSibling,l=o.nextSibling,u=l.nextSibling,h=u.nextSibling;return h.nextSibling,g(s,()=>{var _;return(_=t.msg.total_cost_usd)==null?void 0:_.toFixed(4)},i),g(s,()=>((t.msg.duration_ms??0)/1e3).toFixed(1),l),g(s,()=>t.msg.num_turns,h),k(()=>d(s,p.resultMeta)),s}}),null),k(()=>d(e,`${p.result} ${t.msg.is_error?p.resultError:p.resultSuccess}`)),e}})]}})}function en(t){var s;const e=[];function n(){return e[e.length-1]}for(const r of t)if(r.type==="assistant"){const i=((s=r.message)==null?void 0:s.content)??[],o=i.filter(u=>u.type==="text"),l=i.filter(u=>u.type==="tool_use");if(o.length>0&&e.push({kind:"text",messages:[r],toolBlocks:[]}),l.length>0){const u=n();u&&u.kind==="tool"?(u.messages.push(r),u.toolBlocks.push(...l)):e.push({kind:"tool",messages:[r],toolBlocks:[...l]})}}else if(r.type==="user"){const i=n();i&&i.kind==="tool"?i.messages.push(r):e.push({kind:"tool",messages:[r],toolBlocks:[]})}else e.push({kind:"other",messages:[r],toolBlocks:[]});return e}function nn(t){const e=new Map;for(const n of t){const s=n.name??"tool";e.set(s,(e.get(s)??0)+1)}return Array.from(e.entries()).map(([n,s])=>s>1?`${n} Ã—${s}`:n).join(", ")}function sn(t){const e=()=>t.toolBlocks;return y(G,{get when(){return e().length>0},get fallback(){return(()=>{var n=Ye();return k(()=>d(n,p.toolResult)),n})()},get children(){return y(G,{get when(){return e().length>1},get fallback(){return y(xt,{get name(){return e()[0].name??"tool"},get input(){return e()[0].input}})},get children(){var n=Xe(),s=n.firstChild,r=s.firstChild,i=s.nextSibling;return g(s,()=>e().length,r),g(s,()=>nn(e()),null),g(i,y(nt,{get each(){return e()},children:o=>y(xt,{get name(){return o.name??"tool"},get input(){return o.input}})})),k(o=>{var l=p.toolGroup,u=p.toolGroupInner;return l!==o.e&&d(n,o.e=l),u!==o.t&&d(i,o.t=u),o},{e:void 0,t:void 0}),n}})}})}function xt(t){return(()=>{var e=Ze(),n=e.firstChild,s=n.nextSibling;return g(n,()=>t.name),g(s,()=>JSON.stringify(t.input,null,2)),k(r=>{var i=p.toolBlock,o=p.toolBlockPre;return i!==r.e&&d(e,r.e=i),o!==r.t&&d(s,r.t=o),r},{e:void 0,t:void 0}),e})()}Rt(["click","input"]);function rn(){"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission()}function ln(){return"Notification"in window&&Notification.permission==="granted"}function on(t,e){if(!ln()||document.visibilityState==="visible")return;const n=new Notification("Agent waiting for input",{body:`Task #${t}: ${e}`,tag:`wmao-waiting-${t}`});n.onclick=()=>{window.focus(),n.close()}}const an="_app_17sc8_3",un="_titleRow_17sc8_10",cn="_title_17sc8_10",fn="_subtitle_17sc8_23",dn="_submitForm_17sc8_28",hn="_repoSelect_17sc8_35",gn="_promptInput_17sc8_39",_n="_layout_17sc8_44",mn="_taskList_17sc8_49",bn="_taskListCollapsed_17sc8_53",vn="_placeholder_17sc8_57",pn="_taskCard_17sc8_61",yn="_taskCardSelected_17sc8_69",wn="_taskHeader_17sc8_73",kn="_taskTitle_17sc8_78",$n="_stateBadge_17sc8_82",Sn="_repoLabel_17sc8_88",xn="_branchLabel_17sc8_93",Tn="_costLabel_17sc8_98",Cn="_errorLabel_17sc8_103",An="_detailPane_17sc8_108",En="_backBtn_17sc8_113",S={app:an,titleRow:un,title:cn,subtitle:fn,submitForm:dn,repoSelect:hn,promptInput:gn,layout:_n,taskList:mn,taskListCollapsed:bn,placeholder:vn,taskCard:pn,taskCardSelected:yn,taskHeader:wn,taskTitle:kn,stateBadge:$n,repoLabel:Sn,branchLabel:xn,costLabel:Tn,errorLabel:Cn,detailPane:An,backBtn:En};var Bn=T("<p>No tasks yet."),Ln=T("<div><button>&larr; Back"),In=T('<div><div><h1>wmao</h1><span>Work my ass off. Manage coding agents.</span></div><form><select></select><input type=text placeholder="Describe a task..."><button type=submit></button></form><div><div><h2>Tasks'),Pn=T("<option>"),mt=T("<div>"),Mn=T("<span>$<!> &middot; <!>s"),Nn=T("<div><div><strong></strong><span>");function On(){const[t,e]=J(""),[n,s]=J([]),[r,i]=J(!1),[o,l]=J(null),[u,h]=J([]),[_,c]=J("");let N=new Map;jt(async()=>{rn();const w=await se();h(w),w.length>0&&c(w[0].path)});async function L(){const w=t().trim(),m=_();if(!(!w||!m)){i(!0);try{const $=await ie({prompt:w,repo:m});e(""),await O(),l($.id)}finally{i(!1)}}}async function O(){const w=await re();for(const m of w)m.state==="waiting"&&N.get(m.id)!=="waiting"&&on(m.id,m.task);N=new Map(w.map(m=>[m.id,m.state])),s(w)}setInterval(O,5e3),O();const D=()=>[...n()].sort((w,m)=>{const $=w.task.startsWith("(adopted)")?1:0,C=m.task.startsWith("(adopted)")?1:0;return $!==C?$-C:m.id-w.id}),x=()=>{const w=o();return w===null?null:n().find(m=>m.id===w)??null};return(()=>{var w=In(),m=w.firstChild,$=m.firstChild,C=$.nextSibling,M=m.nextSibling,b=M.firstChild,I=b.nextSibling,Y=I.nextSibling,V=M.nextSibling,q=V.firstChild;return q.firstChild,M.addEventListener("submit",a=>{a.preventDefault(),L()}),b.addEventListener("change",a=>c(a.currentTarget.value)),g(b,y(nt,{get each(){return u()},children:a=>(()=>{var f=Pn();return g(f,()=>a.path),k(()=>f.value=a.path),f})()})),I.$$input=a=>e(a.currentTarget.value),g(Y,()=>r()?"Submitting...":"Run"),g(q,y(G,{get when(){return n().length===0},get children(){var a=Bn();return k(()=>d(a,S.placeholder)),a}}),null),g(q,y(nt,{get each(){return D()},children:a=>(()=>{var f=Nn(),A=f.firstChild,R=A.firstChild,F=R.nextSibling;return f.$$click=()=>l(a.id),g(R,()=>a.task),g(F,()=>a.state),g(f,y(G,{get when(){return a.repo},get children(){var v=mt();return g(v,()=>a.repo),k(()=>d(v,S.repoLabel)),v}}),null),g(f,y(G,{get when(){return a.branch},get children(){var v=mt();return g(v,()=>a.branch),k(()=>d(v,S.branchLabel)),v}}),null),g(f,y(G,{get when(){return a.costUSD>0},get children(){var v=Mn(),W=v.firstChild,U=W.nextSibling,H=U.nextSibling,Z=H.nextSibling;return Z.nextSibling,g(v,()=>a.costUSD.toFixed(4),U),g(v,()=>(a.durationMs/1e3).toFixed(1),Z),k(()=>d(v,S.costLabel)),v}}),null),g(f,y(G,{get when(){return a.error},get children(){var v=mt();return g(v,()=>a.error),k(()=>d(v,S.errorLabel)),v}}),null),k(v=>{var W=`${S.taskCard} ${o()===a.id?S.taskCardSelected:""}`,U=S.taskHeader,H=S.taskTitle,Z=S.stateBadge,st=Gn(a.state);return W!==v.e&&d(f,v.e=W),U!==v.t&&d(A,v.t=U),H!==v.a&&d(R,v.a=H),Z!==v.o&&d(F,v.o=Z),st!==v.i&&te(F,"background",v.i=st),v},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),f})()}),null),g(V,y(G,{get when(){return o()!==null},get children(){var a=Ln(),f=a.firstChild;return f.$$click=()=>l(null),g(a,y(ze,{get taskId(){return o()??0},get taskState(){var A;return((A=x())==null?void 0:A.state)??"pending"},get taskQuery(){var A;return((A=x())==null?void 0:A.task)??""},onClose:()=>l(null)}),null),k(A=>{var R=S.detailPane,F=S.backBtn;return R!==A.e&&d(a,A.e=R),F!==A.t&&d(f,A.t=F),A},{e:void 0,t:void 0}),a}}),null),k(a=>{var f=S.app,A=S.titleRow,R=S.title,F=S.subtitle,v=S.submitForm,W=r(),U=S.repoSelect,H=r(),Z=S.promptInput,st=r()||!t().trim()||!_(),yt=S.layout,wt=`${S.taskList} ${o()!==null?S.taskListCollapsed:""}`;return f!==a.e&&d(w,a.e=f),A!==a.t&&d(m,a.t=A),R!==a.a&&d($,a.a=R),F!==a.o&&d(C,a.o=F),v!==a.i&&d(M,a.i=v),W!==a.n&&(b.disabled=a.n=W),U!==a.s&&d(b,a.s=U),H!==a.h&&(I.disabled=a.h=H),Z!==a.r&&d(I,a.r=Z),st!==a.d&&(Y.disabled=a.d=st),yt!==a.l&&d(V,a.l=yt),wt!==a.u&&d(q,a.u=wt),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0}),k(()=>b.value=_()),k(()=>I.value=t()),w})()}function Gn(t){switch(t){case"done":return"#d4edda";case"failed":return"#f8d7da";case"ended":return"#e2e3e5";default:return"#fff3cd"}}Rt(["input","click"]);const Tt=document.getElementById("app");Tt&&zt(()=>y(On,{}),Tt);
